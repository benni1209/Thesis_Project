# Statistical Matching using a Non-Probability Sample as Auxiliary Dataset

This repository contains all implementation and analysis scripts used in the thesis project.

## Repository Structure

### Estimation Methods
These files contain the implementation of the four estimation methods:

- **`Calibration_Methods.Rmd`**: univariate calibration (X) and full calibration using IPF
- **`EM_Algorithm.Rmd`**: Expectation-Maximization algorithm for multinomial data

### Implementation and Analysis Scripts

Each of the three analyses (MAR, MNAR, Y-Z Association) contain separate scripts for implementation and analysis for clarity and reproducibility. The implementation files generate the data, define the scenarios and apply the estimation methods. They run the monte carlo simulation (1,000 iterations) and saves the results as .rds files. Those files can be loaded into the corresponding analysis scripts to evaluate and analyze performance of the estimation methods.

### Implementation Scripts
These files generate the data and conduct the monte carlo simulation:

- **`MAR_Implementation.Rmd`**: Implementation of Missing At Random mechanisms with multiple selection patterns (linear decrease, U-shaped, step function, extreme increase)
- **`MNAR_Implementation.Rmd`**: Implementation of Missing Not At Random mechanisms (main effects and interaction effects between Y and Z)
- **`YZ-Association_Implementation.Rmd`**: Implementation of various association strenghts between Y and Z with different selection mechanisms

### Analysis Scripts
These files load the monte carlo simulation results generated by the implementation scripts to analysis and evaluate method performances:

- **`MAR_Analysis.Rmd`**: Analysis of method performance under MAR scenarios
- **`MNAR_Analysis.Rmd`**: Analysis of method performance under MNAR scenarios  
- **`YZ-Association_Analysis.Rmd`**: Analysis examining how the strength of Y-Z association affects method performance

### Additional Scripts

- **`Association_Measure_Cramer_s_V_.Rmd`**: Implementation of Cram√©r's V as a measure of association strength between the variables in the population
- **`Quantifying_Interaction.Rmd`**: Quantification of interaction effects in the MNAR selection mechanisms

## Methodology

### Data Generation
The implementation creates synthetic populations with:
- **Variable X**: Categorical auxiliary variable (6 categories)
- **Variables Y and Z**: Outcome variables of interest (3 categories each)

Three samples are drawn from the population:
- **Sample A**: Contains variables X and Y
- **Sample B**: Contains variables X and Z  
- **Sample C**: Contains all three variables (X, Y, Z) but with selection bias

### Selection Mechanisms

#### MAR (Missing At Random)
Selection into Sample C depends on the background variable X:
- Linear decreasing patterns (moderate, baseline & extreme)
- U-shaped selection patterns
- Step function patterns
- Extreme bias scenarios

#### MNAR (Missing Not At Random)  
Selection into Sample C depends on the target variables Y and Z:
- Pure main effects: classic increase, non-monotonic, y-only
- Interaction Effects: weak, moderate, strong, extreme

### Statistical Methods

The following estimation approaches are evaluated:

1. **Raw Sample C**: Unadjusted biased sample
2. **X-Calibration**: Calibrated to population X distribution
3. **Full Calibration**: Calibrated to X, (X,Y) from Sample A, and (X,Z) from Sample B using IPF
4. **EM Algorithm (Raw)**: Applied to the (unadjusted) raw Sample C
5. **EM Algorithm (Calibrated X)**: Applied to X-calibrated Sample C

### Performance Metrics

Methods are evaluated using:
- **Total Absolute Difference (TAD)**: Sum of absolute cell-wise errors
- **Single Worst Cell (SWC) Absolute**: Worst-case cell error
- **Single Worst Cell (SWC) Signed**: Signed error for the most problematic cell

## Requirements

### R Version
- R 4.0.0 or higher recommended

### Required R Packages
```r
# Data manipulation and visualization
library(dplyr)
library(tidyr)
library(ggplot2)
library(gridExtra)
library(reshape2)

# Table formatting
library(knitr)
library(kableExtra)

# Sampling
library(sampling)
```

### Customization

Key parameters can be modified in the implementation scripts:
- `N_pop`: Population size (default: 1,000,000)
- `n_bootstrap`: Number of monte carlo (bootstrap) iterations (default: 1,000)
- Sample sizes for A, B, and C
- Selection mechanisms
- Association structures

## Author

Benedikt Sojka (s4089448)

